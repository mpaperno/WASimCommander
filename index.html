<!-- HTML header for doxygen 1.9.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WASimCommander: WASimCommander</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Logo.png" title="WASimCommander - Remote access to the Microsoft Flight Simulator 2020 Gauge API."/></td>
  <td id="projectalign">
   <div id="projectname"><!-- WASimCommander --><span id="projectnumber">&#160;v1.1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/mpaperno/WASimCommander" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z" fill="url(#gradient)"></path>
    <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
    <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    <linearGradient id="gradient" x1="0.5" x2="0.5" y1="0" y2="1">
        <stop class="first-stop" offset="0%"></stop>
        <stop class="last-stop" offset="100%"></stop>
    </linearGradient>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespace_w_a_sim_commander.html" title="WASimCommander main namespace. Defines constants and structs used in Client-Server interactions....">WASimCommander</a> </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_README"></a> <a href="https://github.com/mpaperno/WASimCommander/releases" target="_blank"><img src="https://img.shields.io/github/v/release/mpaperno/WASimCommander?include_prereleases" alt="GitHub release (latest by date including pre-releases)" class="inline"/></a> <a href="LICENSE.GPL.txt" target="_blank"><img src="https://img.shields.io/badge/license-GPLv3-blue.svg" alt="GPLv3 License" style="pointer-events: none;" class="inline"/></a> <a href="LICENSE.LGPL.txt" target="_blank"><img src="https://img.shields.io/badge/license-LGPLv3-blue.svg" alt="LGPGv3 License" style="pointer-events: none;" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md0"></a>
WASimCommander</h1>
<div align="center"> <img src="https://github.com/mpaperno/WASimCommander/wiki/images/logo/WASim-Logo_640x160.png" alt="" style="width: auto;" class="inline"/> </div><h2><a class="anchor" id="autotoc_md1"></a>
Remote access to the Microsoft Flight Simulator 2020 "Gauge API."</h2>
<p ><b>A WASM module-based Server and a full Client API combination.</b></p>
<p >This project is geared towards other MSFS developers/coders who need a convenient way to remotely access parts of the Simulator which are normally inaccessible via <em>SimConnect</em>, such as locally-defined aircraft variables or custom events.</p>
<p >The Client API can be utilized natively from C++, or via .NET managed assembly from C#, Python, or other languages.</p>
<p >The system also provides direct access to functions from within the Simulator environment and in many cases could be used as a simpler alternative to <em>SimConnect</em> for basic functionality like reading/setting Simulation Variables or triggering Key Events. <em>SimConnect</em> is still used as the network "transport" layer, but this usage is abstracted into, essentially, an implementation detail.</p>
<h3><a class="anchor" id="autotoc_md2"></a>
Motivation</h3>
<p >One of the motivations for this project was seeing multiple MSFS tool authors and casual hackers creating their own WASM modules and protocols just to support their own product or need. There is nothing wrong with this, of course, but for the Sim user it can be a disadvantage on several levels. They may end up running multiple versions of modules which all do eseentially the same thing, and it may be confusing which WASM module they need to support which tool, just to name two obvious issues. For the developer, programming the WASM modules comes with its own quirks, too, not to mention the time involved. And regardless of the supposed isolated environment a WASM module is supposed to run in, it's still very easy to take down the whole Simulator with some errant code... ;-)</p>
<p >Since MS/Asobo have been, ahem, "slow" to add further remote access features to <em>SimConnect</em> (or come up with some other method), this project is an attempt at establishing a "standard" or "common" way of doing so. At the least I hope it motivates <em>some</em> kind of standards adoption.</p>
<p >On a more practical note, I am using it with the <a href="https://github.com/mpaperno/MSFSTouchPortalPlugin" target="_blank">MSFS Touch Portal Plugin</a> which I'm currently maintaining.</p>
<hr  />
 <h3><a class="anchor" id="autotoc_md4"></a>
Features</h3>
<h4><a class="anchor" id="autotoc_md5"></a>
Remote Capabilities</h4>
<ul>
<li><b>Execute Calculator Code</b>:<ul>
<li>With or without a returned result; Result returned as numeric and string types.</li>
<li>Formatted results from <code>format_calculator_string()</code> using <a href="https://docs.flightsimulator.com/html/Additional_Information/Reverse_Polish_Notation.htm#strings" target="_blank">RPN String Formatting</a></li>
</ul>
</li>
<li><b>Get Variable</b>: Return numeric result from any type of variable accessible to a standalone WASM module (basically everything but Gauge and Instrument types, but also including Token vars).<ul>
<li>With optional Unit specifier for variable types which support it.</li>
</ul>
</li>
<li><b>Set Variable</b>: Set the numeric value of any settable variable type, with optional Unit specifier for variable types which support it.</li>
<li><b>Create Variable</b>: Create (and get/set) a new Local variable if it doesn't already exist.</li>
<li><b>List Local Variables</b>: Get a list of all available 'L' variables with their names and current IDs.</li>
<li><b>Lookup</b>: Return a numeric ID for a SimVar/Local/Token variable, Unit, or Key Event name.</li>
<li><b>Subscribe</b> to <em>Calculator Code</em> and <em>Get Variable</em> results:<ul>
<li>Get "push" notifications whenever result values change; Change monitoring can be configured at any rate down to the millisecond (~25ms minimum). Can also be configured to use the "delta epsilon" feature of SimConnect (to ignore insignificant changes in value) or, conversely, to always send updates even when values do not change.</li>
<li>Optionally perform manual ("polled") updates of subscriptions at any interval of your choice.</li>
<li>Any calculator code saved in subscriptions is <b>pre-compiled to a more efficient byte code</b> representation before being passed to the respective calculator functions. This significantly improves performance for recurring calculations.</li>
</ul>
</li>
<li><b>Register Named Events</b>:<ul>
<li>Save recurring "set events," like activiating controls using calculator code, for more efficient and simpler re-use. Saved calculator code is pre-compiled to a more efficient byte code representation before being passed to the calculator function. This significantly improves performance for recurring events.</li>
<li>Registered events can be executed "natively" via <em>WASim API</em> by simply sending a short command with the saved event ID.</li>
<li>Saved events can also be named and executed via standard SimConnect commands <code>SimConnect_MapClientEventToSimEvent(id, "event_name")</code> and <code>SimConnect_TransmitClientEvent(id)</code>.</li>
<li>Event names can be completely custom (including a <code>.</code> (period) as per SimConnect convention), or derive from the connected Client's name (to ensure uniqueness).</li>
</ul>
</li>
<li><b>Send Simulator "Key Events"</b> directly by ID or name (instead of going through the SimConnect mapping process or executing calculator code). Much more efficient than the other methods.<ul>
<li><b>New in v1.1.0:</b> Send Key Events with up to 5 values (like the new <code>SimConnect_TransmitClientEvent_EX1()</code>).</li>
</ul>
</li>
<li><b>Remote Logging</b>: Log messages (errors, warnings, debug, etc) can optionally be sent to the Client, with specific minimum level (eg. only warnings and errros).</li>
<li><b>Ping</b> the Server to check that the WASM module is installed and running before trying to connect or use its features.</li>
</ul>
<h4><a class="anchor" id="autotoc_md6"></a>
Core Components</h4>
<ul>
<li>WASM module-based Server supports multiple simultaneous, independent client connections.</li>
<li>Full-featured Client implementation available as a C++ library and a C#/.NET assembly.</li>
<li>Well-defined message API for communication between Server module and any client implementation.</li>
<li>Uses standard SimConnect messages for the base network "transport" layer.</li>
<li>All data allocations are on client side, so SimConnect limits in WASM module are bypassed (can in theory support unlimited clients).</li>
<li>No wasted data allocations, each data/variable subscription is stored independently avoiding complications with offets or data overflows.</li>
<li>Minimum possible impact on MSFS in terms of memory and CPU usage; practically zero effect for Sim user when no clients are connected (Server is idle).</li>
<li>Server periodically checks that a client is still connected by sending "hearbeat" ping requests and enforcing a timeout if no response is received.</li>
<li>Extensive logging at configurable levels (debug/info/warning/etc) to multiple destinations (file/console/remote) for both Server and Client.<ul>
<li>Uses an efficient <b>lazy logging</b> implementation which doesn't evaluate any arguments if the log message will be discarded anyway (eg. a DEBUG level message when minimum logging level is INFO).</li>
<li>Logging levels can be set at startup via config files and changed at runtime for each facility (including remotely on the server).</li>
</ul>
</li>
<li>Includes a SimConnect request/exception tracking feature for detailed diagnostics.</li>
<li>Extensive documentation for core API and all Client library features.</li>
<li>Efficiency and runtime safety are core requirements.</li>
</ul>
<h4><a class="anchor" id="autotoc_md7"></a>
Desktop GUI</h4>
<ul>
<li>Includes a full-featured desktop application which demonstrates/tests all available features of the API.</li>
<li>Fully usable as a standalone application which saves preferences, imports/exports lists of data subscriptions/registered events, and other usabililty features.</li>
</ul>
<p >&#160; </p>
<div align="center"> <a href="https://github.com/mpaperno/WASimCommander/wiki/images/gui/wasimui-dark-new-v1005.png"><img src="https://github.com/mpaperno/WASimCommander/wiki/images/gui/wasimui-dark-new-v1005.png" alt="" style="width: 65%;" class="inline"/></a> </div> <p >&#160; </p>
<hr  />
 <h3><a class="anchor" id="autotoc_md9"></a>
Downloads</h3>
<p >Over in the <a href="https://github.com/mpaperno/WASimCommander/releases" target="_blank">Releases</a> there are 3 packages provided. (The actual file names have version numbers appended.)</p><ul>
<li><code>WASimCommander_SDK</code> - All header files, pre-built static and dynamic libs, packaged WASM module, pre-build GUI, reference documentation, and other tools/examples.</li>
<li><code>WASimModule</code> - Just the WASM module component, ready to be dropped into a MSFS <em>Community</em> folder.</li>
<li><code>WASimUI</code> - Just the GUI application, which is very handy in combination with the WASM module for exploring the system.</li>
</ul>
<p ><em>Watch</em> -&gt; <em>Custom</em> -&gt; <em>Releases</em> this repo (button at top) or subscribe to the <a href="https://github.com/mpaperno/WASimCommander/releases.atom" target="_blank">ATOM feed</a> for release notifications.</p>
<hr  />
 <h3><a class="anchor" id="autotoc_md11"></a>
Documentation &amp; Examples</h3>
<p >There are three basic console-style tests/examples included for <code>C++</code>, <code>C#</code>, and <code>Python</code> in the <a href="https://github.com/mpaperno/WASimCommander/tree/main/src/Testing" target="_blank">src/Testing</a> folder. If you like reading code, this is the place to start.</p>
<p >API docuemntation generated from source comments is published here: <a href="https://mpaperno.github.io/WASimCommander/">https://mpaperno.github.io/WASimCommander/</a> <br  />
 A good place to start with the docs is probably the <a href="https://mpaperno.github.io/WASimCommander/class_w_a_sim_commander_1_1_client_1_1_w_a_sim_client.html" target="_blank"><code>WASimClient</code></a> page.</p>
<p >The GUI is written in C++ (using Qt library for UI), and while not the simplest example, <em>is</em> a full implementation of almost all the available API features. The main <code>WASimClient</code> interactions all happen in the <code>MainWindow::Private</code> class at the top of the <a href="https://github.com/mpaperno/WASimCommander/tree/main/src/WASimUI/WASimUI.cpp#L80" target="_blank">WASimUi.cpp</a> file.</p>
<p >More to come... or <a href="https://github.com/mpaperno/WASimCommander/tree/main/src" target="_blank">Just Read The Source</a> :-)</p>
<hr  />
 <h3><a class="anchor" id="autotoc_md13"></a>
Troubleshooting</h3>
<h4><a class="anchor" id="autotoc_md14"></a>
WASM Module</h4>
<p >To check status of the WASM module, enable Developer Mode in MSFS, show the "WASM Debug" window (<em>Options</em> -&gt; <em>WASM</em>) and check if the module shows up in the list in that window. If not, then it's not installed. If it does and any of the text is RED, it is installed but crashed for some reason (let me know!). If the text is green then everything is good on that side.</p>
<p >Also in Dev Mode, check the Console for messages. It may show MSFS errors related to the module, and the module itself logs to the console as well. There should be 2 console log messages from the module when it starts up, the latter showing the version number.</p>
<p >The module also logs to a file, though it's a bit tricky to find. On my edition (from MS store) the "working directory" for the modules is <br  />
 <code>D:\WpSystem\S-1-5-21-611220451-769921231-644967174-1000\AppData\Local\Packages\Microsoft.FlightSimulator_8wekyb3d8bbwe\LocalState\packages\wasimcommander-module\work</code></p>
<p >To enable more verbose logging on the module at startup, edit the <code>server_conf.ini</code> file which is found in the module's install folder (<code>Comunity\wasimcommander-module\modules</code>). There are comments in there indicating the options.</p>
<p >Keep in mind that the server logging level can also be changed remotely at runtime, but of course that only works if you can establish a connection to the module in the first place.</p>
<h4><a class="anchor" id="autotoc_md15"></a>
WASimClient (or anything using it, like WASimUI)</h4>
<p >Basically the log is the primary source of information here. By default it logs at the "Info" level to: 1) The current console window, assuming there is one (the host app is started from a console). So if using <code>WASimUI</code>, for example, just start it from a command prompt. 2) A file in whatever current directory it is running in (so, for the UI, that would be the UI's install folder).</p>
<p >Of course if you're using <code>WASimUI</code>, it also provides a full logging interface and you can set all the log levels from there, for both client and server sides.</p>
<p >There should also be a <code>client_conf.ini</code> file alongside whatever is using the Client where initial logging location, levels and network configuration (timeout and SimConnect.cfg index) is set. The config file has comments indicating the available options.</p>
<hr  />
 <h3><a class="anchor" id="autotoc_md17"></a>
Issues, Support, Suggestions, Discussion</h3>
<p >The GitHub repository is the primary source of all these things. You know what to do...</p>
<p >Use the <a href="https://github.com/mpaperno/WASimCommander/issues" target="_blank">Issues</a> feature for bug reports and concise feature suggestions.</p>
<p >Use <a href="https://github.com/mpaperno/WASimCommander/discussions" target="_blank">Discussions</a> for any other topic.</p>
<p >Most flight simulator forums seem fairly strict about <em>not</em> using their site to provide product support. So please use GitHub, unless you're absolutely sure no rules would be broken or toes stepped upon otherwise.</p>
<hr  />
 <h3><a class="anchor" id="autotoc_md19"></a>
Credits</h3>
<p >This project is written, tested, and documented by myself, Maxim (Max) Paperno.<br  />
 <a href="https://github.com/mpaperno/">https://github.com/mpaperno/</a></p>
<p >Uses and includes a slightly modified version of <a href="https://github.com/jgaa/logfault" target="_blank"><em>logfault</em> by Jarle Aase</a>, used under the MIT license. Changes documented in the code.</p>
<p >Uses and includes <a href="https://github.com/mcmtroffaes/inipp" target="_blank"><em>IniPP</em> by Matthias C. M. Troffaes</a>, used under the MIT license.</p>
<p >Uses the <em>Microsoft SimConnect SDK</em> under the terms of the <em>MS Flight Simulator SDK EULA (11/2019)</em> document.</p>
<p >The GUI component uses portions of the <a href="http://qt.io" target="_blank"><em>Qt Library</em></a> under the terms of the GPL v3 license.</p>
<p >The GUI component uses and includes the following symbol fonts for icons, under the terms of their respective licenses:</p><ul>
<li><a href="https://icomoon.io/#icons-icomoon" target="_blank">IcoMoon Free</a> - IcoMoon.io, GPL v3.</li>
<li><a href="https://material.io/" target="_blank">Material Icons</a> - Google, Apache License v2.0.</li>
</ul>
<hr  />
 <h3><a class="anchor" id="autotoc_md21"></a>
Copyright, License, and Disclaimer</h3>
<p ><a class="el" href="namespace_w_a_sim_commander.html" title="WASimCommander main namespace. Defines constants and structs used in Client-Server interactions....">WASimCommander</a> Project <br  />
 COPYRIGHT: Maxim Paperno; All Rights Reserved.</p>
<h4><a class="anchor" id="autotoc_md22"></a>
API Library and Client Components</h4>
<p >Dual licensed under the terms of either the GNU General Public License (<b>GPL</b>) or the GNU Lesser General Public License (<b>LGPL</b>), as published by the Free Software Foundation, either <b>version 3</b> of the Licenses, or (at your option) any later version.</p>
<h4><a class="anchor" id="autotoc_md23"></a>
WASM Module Server and GUI Components</h4>
<p >Licensed under the terms of the GNU General Public License (<b>GPL</b>) as published by the Free Software Foundation, either <b>version 3</b> of the License, or (at your option) any later version.</p>
<h4><a class="anchor" id="autotoc_md24"></a>
General</h4>
<p >This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p >Copies of the GNU GPL and LGPL are included with this project and are available at <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
<p >Except as contained in this copyright notice, the names of the authors or their institutions shall not be used in advertising or otherwise to promote the sale, use, or other dealings in, any product using this Software, or any derivative of this Software, without prior written authorization from the authors.</p>
<p >This project may also use 3rd-party Open Source software under the terms of their respective licenses. The copyright notice above does not apply to any 3rd-party components used within. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Nov 1 2022 23:28:07 for WASimCommander by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
